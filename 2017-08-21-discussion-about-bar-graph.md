---
title: "漫谈条形图"
date: '2017-08-20'
author: "黄湘云 李宇轩"
tags: ["条形图"]
slug: discussion_about_bar_graph
---

这篇文章的起因是源于COS论坛中的下图，该图引起了热烈的讨论，具体的探讨细节[见此](https://d.cosx.org/d/417769)，正好借此机会，和大家一起探讨条形图的一些制作规范。

![图0：文章起因条形图](https://user-images.githubusercontent.com/12031874/28810063-2fe63496-76ba-11e7-88be-e0c9d14dd486.png)

**图0：文章起因条形图**

基本条形图要满足三个原则：**有效**，能够向读者传递重要信息；**简洁**，尽量用最少的图形传递最多的信息，不要有赘余；**美观**，图形做出来得让大家能看进去，不要太反人类。横纵坐标是判定使用哪种类型的条形图的主力军，因此我们围绕横纵坐标的三类问题展开叙述：坐标长度问题、坐标分类问题、坐标数值问题。前两个问题着重点在于选择什么样的条形图，而第三个问题则着重在于坐标应该如何调整。在这三类问题之后，我们将立方条形图单独拿出来分析。

在解决这些问题的同时我们也来查看图形颜色的情况，整体来说图形颜色需要满足两个要求：第一个是颜色跨度要适中，不能跨度太小让大家辨别颜色太费劲，也不能跨度太大显得图形特别乱，找不到重点；第二个是要根据情况来决定使用渐变色还是分类色，让图形变得美观。事实证明，选择不应过多依赖图形的形状，而更多的应该在于利用好审美。

# 1.坐标长度问题

## 1.1 横躺条形图与竖立条形图

这个问题描述的是坐标名称特别长的情况下应该如何处理。当坐标比较短时，这也是绘制条形图的大部分情况，用正立条形图或者横躺条形图都是可以的，比如下图1，这个图横竖都非常美观，在此就不放横躺条形图的样式了。

![图1：泊松分布](https://user-images.githubusercontent.com/12031874/29483578-d90c9658-84db-11e7-85c9-d44db8994d33.png)

**图1：泊松分布**

当坐标比较长或者比较多时，在正立条形图和横躺条形图中我们就只能使用横躺条形图了，如下图2：

![图2：横躺条形图正例](https://user-images.githubusercontent.com/12031874/28816143-4c16e1e4-76d6-11e7-8176-cc3cf0ced603.png)

**图2：横躺条形图正例**

上图2则是横躺条形图的一个典型代表，分类变量又多又长，所以把它横过来放大家看着更方便一些。下图3则是这张图的反例：

![图3：正立条形图反例](https://user-images.githubusercontent.com/12031874/28815599-7b307cc6-76d4-11e7-88a4-f3c5284cda08.png)

**图3：正立条形图反例**

图3为了避免横坐标过长导致的图形过宽，因此将横坐标都做了一定角度的倾斜，这种倾斜自然影响了读者阅读这些横坐标，所以从简洁角度来讲，还是横躺条形图更美观一些。

如果坐标虽然很多，但是这些坐标是连续性的数字的话，我们依旧可以把它竖过来放，因为连续性坐标可以省略其中的大部分坐标，不用明确标出，如下图4：

![图4：竖立条形图](https://user-images.githubusercontent.com/12031874/29704567-f2af53fe-89ac-11e7-896a-53232349181a.png)

**图4：竖立条形图**

## 1.2 点图

除了横躺条形图之外，当坐标长度过长或者坐标过多时，我们还有另外一个选项，就是点图：

![图5：车型、气缸数和每加仑里程的关系](https://user-images.githubusercontent.com/12031874/29484779-6562d9d4-84f8-11e7-8955-4108a17d1984.png)

**图5：车型、气缸数和每加仑里程的关系**

这张点图要是把它竖过来放实在太恐怖了...我是没有勇气把它的反例放上来的。由此来说，在坐标特别多的时候，点图要更好用一些。下面这张点图也是如此：

![图6：CRAN上发布R包最多的53人](https://user-images.githubusercontent.com/12031874/29740087-1378d40a-8a81-11e7-949f-3be5956df129.png)

**图6：CRAN上发布R包最多的53人**

这张点图则是百尺竿头更进一步，不止是竖过来不忍直视，就连做成横躺条形图都会挤成一块，同样为了不让大家的视线受到过多的污染，我就不放这张图的反例了。由此来说的话，最开始引起争端的图0也可以绘制成横躺的点图，但在此就不放上来了。

## 1.3 图形颜色

图形颜色在正立条形图、横躺条形图中是一个大问题，因为本身图形简单，所以颜色的好坏便决定了这张图是否美观，也决定了这张图能否完整表达想要传达的信息。

对此我的建议是，如果颜色所传递的信息能由其他因素，比如说条形图柱子的高度来反映，那么这种颜色是着实没有必要的。所以对于那些没有什么特殊信息，只是想比较柱子高低的条形图，只用一种颜色就行了，我们先来看这种情况的反例：

![图7：图形颜色反例](https://user-images.githubusercontent.com/12031874/28810279-7aa94ecc-76bb-11e7-84f6-3f26bd5eaeaf.png)

**图7：图形颜色反例**

再拿这张之前用过的图形当正例作比较：

![图8：图形颜色正例](https://user-images.githubusercontent.com/12031874/28812405-2a9aca1c-76c7-11e7-9bbf-493a7e73e196.png)

**图8：图形颜色正例**

两张图我们仔细查看的话，可以发现传递的信息是一样的，但第一张图还要慢慢查看哪个柱子对应哪个图例，而第二张图则没有这个必要，也就是说第二张图更简洁；此外，第一张图中颜色太多，让人眼花缭乱，但实际上却没有什么重要作用，所以对于正立条形图和横躺条形图，如果颜色不能传达其他信息的话，最好统一颜色。颜色图例的使用是一个需要仔细琢磨的问题，个人认为颜色图例在普通的正立条形图和横躺条形图中的使用并不是很重要，因为这些条形图中柱子本身有高低，因此已经产生了区别，再使用颜色图例只是类似“锦上添花”，而非必要品，当然，如果我们想着重强调条形图中的某个或某些柱子，加上颜色加以区分是有必要的，因为此时的颜色可以突出一些关键信息，此时也要酌情来看是否需要加上图例。

# 2.坐标分类问题

## 2.1 分类条形图和堆积条形图
坐标分类一般都集中在横坐标，当坐标有两层分类时，我们一般有两种解决办法：绘制分类条形图或者堆积条形图。坐标分类本身并不是一个难事，大家看到了两层分类，自然就会想到使用这两种图形，重点在于颜色问题，我们首先来看最常见的分类条形图：

![图9：冈比亚儿童患疟疾情况](https://user-images.githubusercontent.com/12031874/29740264-234eedde-8a85-11e7-8425-5a60cda96845.png)

**图9：冈比亚儿童患疟疾的影响因素（是否有蚊帐，蚊帐是否杀虫，RDT表示快速诊断结果：0表示没有感染疟疾，1表示感染疟疾）**

图9这张分类条形图中规中矩，利用颜色区分了不同的情况，颜色的不同也产生了对比，此时颜色图例自然是有必要的。分类条形图在类型比较多时用的也较多，因为类型少时，我们同时可以使用堆积条形图，而类型多时，堆积条形图就没有那么直观了，如下图10：

![图10：1940年弗吉尼亚州各年龄段死亡率（单位千分之一）](https://user-images.githubusercontent.com/12031874/29483581-e44f0cee-84db-11e7-9b72-52b12b66cd11.png)

**图10：1940年弗吉尼亚州各年龄段死亡率（单位千分之一）**

图10颜色区别比较明显，同时颜色跨度又不是很大，不会显得图形非常乱。再请大家看下面这两张反例图（注意，前方高能！）：

![图11：美国每十年从欧洲移民情况1](http://gnuplot.sourceforge.net/demo/histograms.4.png)

**图11：美国每十年从欧洲移民情况1**

![图12：美国每十年从欧洲移民情况2](http://gnuplot.sourceforge.net/demo/histograms.6.png)

**图12：美国每十年从欧洲移民情况2**

这两张图实在是有些难以接受...两张图都是颜色过多，利用堆积条形图有些部分小的几乎
可以忽略，另外竟然还有国家选的颜色特别相近，很难判定哪个是哪个。所以当堆积的有些多时，就不适合这种方式了，一方面是眼花缭乱，找不到重点；另外一方面是有些颜色趋于相近，可能会引起误解。整体来看，当分类的变量比较少时，利用堆积条形图是个不错的选择，但当分类变量较多时，再使用堆积条形图就会严重影响图形的美观与解读。

## 2.2 复合条形图

由此来看，在分类的变量比较多时，分类柱状图要好于堆积柱状图，但我们也要灵活使用。此时复合条形图就要登场了，复合条形图就是指既有分类，又有堆积的条形图，如下图：

![图13：1973年加州大学伯克利分校最大的六个系学生录取情况](https://user-images.githubusercontent.com/12031874/29483635-15bb4ac6-84dd-11e7-9c63-e36ef69a9eb5.png)

**图13：1973年加州大学伯克利分校最大的六个系学生录取情况**

复合条形图所传递的信息要多于其他的图形，上面这张图便是既展现了同一人群中录取和拒绝的区别，也展现了同一系中男女的区别。同样，内容较多时使用复合条形图要好于上述单独的分类条形图或者堆积条形图。比如下面两张图：

![图14：美国每十年从欧洲移民情况3](http://gnuplot.sourceforge.net/demo/histograms.7.png)

**图14：美国每十年从欧洲移民情况3**

![图15：美国每十年从欧洲移民情况4](http://gnuplot.sourceforge.net/demo/histograms.8.png)

**图15：美国每十年从欧洲移民情况4**

图15那张复合条形图明显要好于前面的图14，主要好在三点：一点是堆积的少，颜色变化也大，能看清楚；第二点是它相当于多加了一个地区的分类归组，可以再进行一些有趣的研究；第三点是由于横坐标很多，这样一个横坐标对应一个柱子还是容易看的，像反例那个分类条形图，柱子过多，有可能看一会就会搞混。

# 3.坐标数值问题

## 3.1 坐标跨度

坐标跨度的问题和颜色的关系不是很大，主要就是纵坐标的取值范围。我们通常都会将纵坐标从零开始，但是有些图形的纵坐标从零开始，会使得条形图中的柱子高度比较高，如图16：

![图16：国际航班乘客示意图](https://user-images.githubusercontent.com/12031874/29484850-10bf2d36-84fa-11e7-8343-3e7bb09209e8.png)

**图16：国际航班乘客示意图**

这张图中各柱子取值范围普遍都高于200，纵坐标从零开始取会显得图形占满了整片空间的大部分区域，非常不美观，条形图的美观很大程度上是由柱子的高低差异特别大而显现出来的，如我们之前用过的泊松分布：

![图17：泊松分布](https://user-images.githubusercontent.com/12031874/29483578-d90c9658-84db-11e7-85c9-d44db8994d33.png)

**图17：泊松分布**

图17中柱子高度的变化幅度大，使得这张图显得有层次感，高低不平，非常美观。因此我们要慎重选择图形坐标的跨度，如果条形图中柱子高度普遍低于或者高于某一数值时，我们应该及时根据这些情况进行调整。

## 3.2 坐标顺序

坐标顺序的问题主要是指如何对横坐标进行排序并绘图，我的建议是：如果横坐标本身就是有顺序的，比如连续性的数值或者月份，那么就按照横坐标自身的顺序进行排列就好，这两种类型的图形例如上面的图16和图17，在这里就不再放一次了；如果横坐标本身只是分类变量，没有固定顺序，那么最好按照柱子高度从高到底或者从低到高的顺序进行绘图，如下图18：

![图18：机器类型、价格及数量条形图](https://github.com/MikeLYX/picture/blob/master/some%20described%20picture/picture1.png?raw=true)

**图18：机器类型、价格及数量条形图**

图18既是一张正例图，又是一张反例图：正例图在于展现了从低到高的顺序，同时它也展现了颜色的另外一种用法，便是传递除纵坐标外的另一种信息，在这里就是指数量的多少；但说它也是一张反例图是因为它的纵坐标普遍高于20，因此为了图形美观，应该让纵坐标从20起始，此外，颜色越深，应该代表数量越多，但显然这张图中的颜色与我们通常的做法正好相反了。总体来说，坐标顺序的不同能很大程度影响图形的美观程度。

## 3.3 坐标大小

坐标大小的问题主要体现在横纵坐标的表现方式上，当横纵坐标数量级较小时，我们一般就会直接呈现数字大小，但是如果横纵坐标数量级较大的话，如达到十万、百万级别时，直接呈现数字会给读者阅读造成一定困难，因为坐标不是非常直观。由此则有两种解决办法，一种是科学计数法，如之前用过的图11，科学计数法就会显得非常美观；另一种则是取对数操作，取对数一方面好处是图形直观，另一方面好处是能够缩小柱子的高度差异，如果柱子之间高度差异过大，使用普通取值范围的条形图则会将某些柱子压的太低。正例如下图19：

![图19：R包与开发人数示意图](https://user-images.githubusercontent.com/12031874/29740193-954a5344-8a83-11e7-9108-f6ea78ccedbd.png)

**图19：R包与开发人数示意图**

反例在此就不放了，这张图的反例实在是辣眼睛。坐标的大小并不影响解读，它主要影响图形的美观，对坐标进行一定的处理，让它变得美观是很有必要的。

# 4.立方条形图

我们将单独把立方条形图拿出来，是因为立方条形图有两点和二维条形图有明显区别：第一点是立方条形图是三维的，呈现了两类横坐标与纵坐标之间的关系；
第二点是立方条形图中的渐变色运用很多，而二维条形图中渐变色运用较少。因此立方条形图中主要需要注意的就是颜色的变化情况，下面图形都是作为正例出现，不再举反例。

![图20：立方条形图1](https://camo.githubusercontent.com/3b5e0b00f0d7c2425aaa9567869b5e41d426a0d4/687474703a2f2f7777772e637077617264656c6c2e636f6d2f77702d636f6e74656e742f75706c6f6164732f323031352f30382f6370775f636f6e746578745f7472616e73706172656e742e706e67)

**图20：立方条形图1**

这张图中的各个柱子没有明显趋势，但有明显分类，而这种横坐标之间也没有明显关系的图形，利用不同的颜色要比渐变色更好。渐变色更适合用于那些横坐标之间有连续关系的图形，如下面的图21,图22和图23：

![图21：立方条形图2](https://user-images.githubusercontent.com/12031874/29644438-993e3efc-88a8-11e7-94ba-c04e57f15e4c.png)

**图21：立方条形图2**

图21展现了每月航班人数的变化情况，这张图中的颜色从黄色渐变到最后的紫色，虽然跨度很大，但也不是很显乱。像这种希望能够凸显出最高的区域或者最低区域的图形，利用柱子高低顺序进行颜色变化是个不错的选择。

![图22：立方条形图3](https://camo.githubusercontent.com/94b37eff9b6d18bf7f9c92da5cb1b755d0bcae62/68747470733a2f2f636e2e6d617468776f726b732e636f6d2f6d61746c616263656e7472616c2f6d6c632d646f776e6c6f6164732f646f776e6c6f6164732f7375626d697373696f6e732f35323036372f76657273696f6e732f312f73637265656e73686f742e6a7067)

**图22：立方条形图3**

图22也是利用柱子高低变化产生了渐变色，但相比图21，这张图能够更直观展现柱子的高低程度，同时图形的角度也是一个俯视角度，虽然图形中没有什么明显的趋势，但能够把那些比较重要、比较突出的点更好地反映出来。

![图23：立方条形图4](https://camo.githubusercontent.com/f1c1614b5e5e28f8c2a8b94eb952adc1319c76b0/68747470733a2f2f7777772e6d617468776f726b732e636f6d2f6d61746c616263656e7472616c2f6d6c632d646f776e6c6f6164732f646f776e6c6f6164732f7375626d697373696f6e732f33353237342f76657273696f6e732f332f70726576696577732f68746d6c2f4261725f506c6f745f33445f30312e706e67)

**图23：立方条形图4**

相比图21和图22，图23则显得比较“单纯”,它的颜色渐变只是根据月份的逐步变化实现的，这张图中的颜色实际上只是起到了区分不同月份的作用。

# 5.总结

条形图的应用一共有三原则：有效、美观、简洁；条形图的颜色则有两要求：跨度适中、图形美观。条形图类型的选择会受到横纵坐标的限制，颜色则是为条形图“锦上添花”的。

但大多数情况下，正立条形图和横躺条形图都是可以使用的，只有在某些特定情况下，二者才会有优劣，点图亦是如此；相比之下，分类条形图和堆积条形图则不然，在类型特别多的情形下，分类条形图的确要比堆积条形图好用的多，但如果传递的信息太多或者分类层数过多，使用复合条形图也是不错的选择；而立方条形图的颜色要比二维条形图颜色有更多的发挥空间，不过由于大部分横坐标的连续性，可能这种空间很多都发挥在了渐变色上面。

# 参考文献

1. R Core Team (2017). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria.
  URL https://www.R-project.org/.

2. Karline Soetaert (2016). plot3D: Plotting Multi-Dimensional Data. R package version 1.1. https://CRAN.R-project.org/package=plot3D

3. Thomas Rahlf (2017). Data Visualisation with R – 100 Examples, Springer. eBook ISBN: 978-3-319-49751-8, Hardcover ISBN: 978-3-319-49750-1.

4. <http://gnuplot.sourceforge.net/demo/histograms.html>

5. Hadley Wickham (2009). ggplot2: Elegant Graphics for Data Analysis, Springer-Verlag New York. ISBN: 978-0-387-98140-6. URL http://ggplot2.org

6. Daniel Lüdecke (2017). sjPlot: Data Visualization for Statistics in Social Science. R package version 2.3.2. https://CRAN.R-project.org/package=sjPlot

7. Daniel Lüdecke (2017). sjmisc: Miscellaneous Data Management Tools. R package version 2.6.0. https://CRAN.R-project.org/package=sjmisc 

8. Paulo J. Ribeiro Jr and Peter J. Diggle (2016). geoR: Analysis of Geostatistical Data. R package version 1.7-5.2. https://CRAN.R-project.org/package=geoR

9. Simon Garnier (2017). viridis: Default Color Maps from 'matplotlib'. R package version 0.4.0. https://CRAN.R-project.org/package=viridis

10. Alboukadel Kassambara (2017). ggpubr: 'ggplot2' Based Publication Ready Plots. R package version 0.1.4. https://CRAN.R-project.org/package=ggpubr

11. <https://datascienceplus.com/building-barplots-with-error-bars/>

12. <http://gnuplot.sourceforge.net/demo/histograms2.html>

